<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>페이크 데이터 완전 삭제</title>
    <script src="js/super-block-sw.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-screen p-4">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-sm p-6">
        <h1 class="text-2xl font-bold text-gray-800 mb-6">
            <i class="fas fa-trash-alt text-red-600 mr-3"></i>
            페이크 데이터 완전 삭제
        </h1>

        <div class="space-y-6">
            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                <h2 class="text-lg font-semibold text-red-800 mb-2">⚠️ 주의사항</h2>
                <p class="text-red-700">
                    이 도구는 localStorage에 저장된 모든 테스트/페이크 데이터를 완전히 삭제합니다.
                    실제 데이터가 있다면 백업을 먼저 받으세요.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="showCurrentData()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg">
                    <i class="fas fa-eye mr-2"></i>
                    현재 데이터 확인
                </button>
                
                <button onclick="clearAllFakeData()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg">
                    <i class="fas fa-trash-alt mr-2"></i>
                    모든 페이크 데이터 삭제
                </button>
            </div>

            <div id="output" class="bg-gray-50 rounded-lg p-4 min-h-32">
                <p class="text-gray-500">작업 결과가 여기에 표시됩니다...</p>
            </div>
        </div>
    </div>

    <script>
        function showCurrentData() {
            const output = document.getElementById('output');
            
            const investorData = localStorage.getItem('investorData');
            const accommodationData = localStorage.getItem('accommodationData');
            const accountingData = localStorage.getItem('accountingData');
            
            let result = '<h3 class="font-bold mb-2">현재 localStorage 데이터:</h3>';
            
            if (investorData) {
                const investors = JSON.parse(investorData);
                result += `<p><strong>투자자 데이터:</strong> ${investors.length}개</p>`;
                investors.forEach((inv, i) => {
                    result += `<p class="ml-4">- ${inv.name || inv.id} (${inv.accommodations?.length || 0}개 숙소)</p>`;
                });
            } else {
                result += '<p><strong>투자자 데이터:</strong> 없음</p>';
            }
            
            if (accommodationData) {
                const accommodations = JSON.parse(accommodationData);
                result += `<p><strong>숙소 데이터:</strong> ${accommodations.length}개</p>`;
                accommodations.forEach((acc, i) => {
                    result += `<p class="ml-4">- ${acc.name || acc.accommodationName || acc.id}</p>`;
                });
            } else {
                result += '<p><strong>숙소 데이터:</strong> 없음</p>';
            }
            
            if (accountingData) {
                const accounting = JSON.parse(accountingData);
                result += `<p><strong>회계 데이터:</strong> ${accounting.length}건</p>`;
                const income = accounting.filter(item => item.type === 'income').length;
                const expense = accounting.filter(item => item.type === 'expense').length;
                result += `<p class="ml-4">- 수입: ${income}건, 지출: ${expense}건</p>`;
            } else {
                result += '<p><strong>회계 데이터:</strong> 없음</p>';
            }
            
            output.innerHTML = result;
        }
        
        function clearAllFakeData() {
            if (!confirm('정말로 모든 데이터를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                return;
            }
            
            const output = document.getElementById('output');
            
            try {
                // localStorage에서 주요 데이터 키 삭제
                const keysToRemove = [
                    'investorData',
                    'accommodationData', 
                    'accountingData',
                    'reservationData',
                    'testData',
                    'fakeData'
                ];
                
                let result = '<h3 class="font-bold mb-2 text-green-600">✅ 삭제 완료:</h3>';
                
                keysToRemove.forEach(key => {
                    if (localStorage.getItem(key)) {
                        localStorage.removeItem(key);
                        result += `<p class="text-green-600">- ${key} 삭제됨</p>`;
                    } else {
                        result += `<p class="text-gray-500">- ${key} 없었음</p>`;
                    }
                });
                
                // 테스트용 ID가 포함된 데이터도 확인
                const allKeys = Object.keys(localStorage);
                const testKeys = allKeys.filter(key => 
                    key.includes('test') || 
                    key.includes('fake') ||
                    key.includes('Test') ||
                    key.includes('Fake')
                );
                
                if (testKeys.length > 0) {
                    result += '<p class="mt-2 font-semibold">추가 테스트 키 발견:</p>';
                    testKeys.forEach(key => {
                        localStorage.removeItem(key);
                        result += `<p class="text-orange-600">- ${key} 삭제됨</p>`;
                    });
                }
                
                result += '<p class="mt-4 font-bold text-blue-600">🎉 모든 페이크 데이터 삭제 완료!</p>';
                result += '<p class="text-sm text-gray-600 mt-2">이제 새로고침하여 확인하세요.</p>';
                
                output.innerHTML = result;
                
                // 3초 후 페이지 새로고침 제안
                setTimeout(() => {
                    if (confirm('페이크 데이터가 삭제되었습니다. 대시보드 페이지로 이동하시겠습니까?')) {
                        window.location.href = 'index.html';
                    }
                }, 2000);
                
            } catch (error) {
                output.innerHTML = `<p class="text-red-600">❌ 삭제 중 오류 발생: ${error.message}</p>`;
            }
        }
        
        // 페이지 로드 시 자동으로 현재 데이터 표시
        document.addEventListener('DOMContentLoaded', function() {
            showCurrentData();
        });
    </script>
</body>
</html>