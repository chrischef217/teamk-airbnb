<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teamk íƒœêµ­ ì—ì–´ë¹„ì•¤ë¹„ ìˆ™ë°•ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <!-- SUPER SERVICE WORKER BLOCKER (100% ì™„ì „ ì°¨ë‹¨) -->
    <script src="js/super-block-sw.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/firebase-storage.js"></script>
    <script src="js/translations.js"></script>

    <style>
        body { 
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
        }
        .kpi-card {
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        .tab-button {
            transition: all 0.2s ease-in-out;
        }
        .tab-button:hover {
            background-color: #f3f4f6;
        }
        .property-card {
            transition: box-shadow 0.2s ease-in-out;
        }
        .property-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-2 sm:px-4 py-4 sm:py-8">
        <!-- Header -->
        <div class="mb-6">
            <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                <h1 class="text-2xl font-bold text-gray-800 mb-2" data-translate="systemTitle">
                    Teamk íƒœêµ­ ì—ì–´ë¹„ì•¤ë¹„ ìˆ™ë°•ê´€ë¦¬ ì‹œìŠ¤í…œ
                </h1>

            </div>
            
            <!-- Tab Navigation -->
            <div class="bg-white rounded-lg shadow-sm mb-6">
                <div class="flex flex-wrap border-b">
                    <button class="px-4 py-3 text-sm font-medium text-white bg-blue-600 border-b-2 border-blue-600 rounded-tl-lg">
                        <i class="fas fa-tachometer-alt mr-1"></i> <span data-translate="dashboard">ëŒ€ì‹œë³´ë“œ</span>
                    </button>
                    <button onclick="window.location.href='accommodation.html'" class="px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-800">
                        <i class="fas fa-home mr-1"></i> <span data-translate="accommodations">ìˆ™ì†Œ ê´€ë¦¬</span>
                    </button>
                    <button onclick="window.location.href='reservation.html'" class="px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-800">
                        <i class="fas fa-calendar-check mr-1"></i> <span data-translate="reservations">ì˜ˆì•½ ê´€ë¦¬</span>
                    </button>

                    <button onclick="window.location.href='accounting.html'" class="px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-800">
                        <i class="fas fa-coins mr-1"></i> <span data-translate="accounting">ìˆ˜ìµ ê´€ë¦¬</span>
                    </button>
                    <button onclick="window.location.href='investor.html'" class="px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-800">
                        <i class="fas fa-users mr-1"></i> <span data-translate="investors">íˆ¬ìì ê´€ë¦¬</span>
                    </button>
                    <button onclick="window.location.href='settlement.html'" class="px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-800">
                        <i class="fas fa-calculator mr-1"></i> <span data-translate="settlement">íˆ¬ìì ì •ì‚°</span>
                    </button>

                    <button onclick="window.location.href='data-migration.html'" class="px-4 py-3 text-sm font-medium text-gray-600 hover:text-gray-800">
                        <i class="fas fa-database mr-1"></i> ë°ì´í„° ê´€ë¦¬
                    </button>
                </div>
            </div>
        </div>

        <!-- ìë™ ë™ê¸°í™” ìƒíƒœ ì•Œë¦¼ -->
        <div id="syncStatusAlert" class="hidden mb-6 p-4 rounded-lg shadow-sm border-l-4 border-blue-500 bg-blue-50">
            <div class="flex items-center">
                <i id="syncIcon" class="fas fa-sync-alt animate-spin text-blue-600 mr-3"></i>
                <div class="flex-1">
                    <h4 class="text-blue-800 font-semibold">ë°ì´í„° ë™ê¸°í™” ì§„í–‰ ì¤‘</h4>
                    <p id="syncMessage" class="text-blue-600 text-sm">Firebaseì—ì„œ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...</p>
                </div>
                <button id="manualSyncBtn" onclick="performAutoSync()" 
                        class="ml-4 px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
                    <i class="fas fa-redo mr-1"></i> ìˆ˜ë™ ë™ê¸°í™”
                </button>
            </div>
        </div>

        <!-- Key Metrics Summary - 6ê°œ ì™„ì „ KPI ì¹´ë“œ -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8">
            <!-- ì´ ìˆ™ì†Œ ìˆ˜ ì¹´ë“œ -->
            <div class="bg-gradient-to-r from-purple-400 to-purple-500 rounded-lg p-6 text-white relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="text-sm font-medium opacity-90 mb-2">ì´ ìˆ™ì†Œ ìˆ˜</h3>
                    <p class="text-3xl font-bold mb-1" data-kpi="total-properties">0ê°œ</p>
                </div>
                <div class="absolute top-4 right-4 text-4xl opacity-30">
                    <i class="fas fa-home"></i>
                </div>
            </div>
            
            <!-- ì´ íˆ¬ìê¸ˆ ì¹´ë“œ -->
            <div class="bg-gradient-to-r from-indigo-400 to-indigo-500 rounded-lg p-6 text-white relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="text-sm font-medium opacity-90 mb-2">ì´ íˆ¬ìê¸ˆ</h3>
                    <p class="text-3xl font-bold mb-1" data-kpi="total-investment">0 THB</p>
                </div>
                <div class="absolute top-4 right-4 text-4xl opacity-30">
                    <i class="fas fa-piggy-bank"></i>
                </div>
            </div>
            
            <!-- ì´ ìˆ˜ìµ ì¹´ë“œ -->
            <div class="bg-gradient-to-r from-pink-400 to-pink-500 rounded-lg p-6 text-white relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="text-sm font-medium opacity-90 mb-2">ì´ ìˆ˜ìµ</h3>
                    <p class="text-3xl font-bold mb-1" data-kpi="total-revenue">0 THB</p>
                </div>
                <div class="absolute top-4 right-4 text-4xl opacity-30">
                    <i class="fas fa-coins"></i>
                </div>
            </div>
            
            <!-- ì´ ìˆœìˆ˜ìµ ì¹´ë“œ -->
            <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-6 text-white relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="text-sm font-medium opacity-90 mb-2">ì´ ìˆœìˆ˜ìµ</h3>
                    <p class="text-3xl font-bold mb-1" data-kpi="net-profit">0 THB</p>
                </div>
                <div class="absolute top-4 right-4 text-4xl opacity-30">
                    <i class="fas fa-chart-line-up"></i>
                </div>
            </div>
            

            
            <!-- ì ìœ ìœ¨ ì¹´ë“œ -->
            <div class="bg-gradient-to-r from-orange-400 to-orange-500 rounded-lg p-6 text-white relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="text-sm font-medium opacity-90 mb-2">ì ìœ ìœ¨</h3>
                    <p class="text-3xl font-bold mb-1" data-kpi="occupancy-rate">0%</p>
                </div>
                <div class="absolute top-4 right-4 text-4xl opacity-30">
                    <i class="fas fa-calendar-check"></i>
                </div>
            </div>
        </div>



        <!-- ìƒì„¸ ë°ì´í„° í…Œì´ë¸” -->
        <div class="bg-white rounded-lg shadow-sm overflow-hidden mb-8">
            <div class="bg-gray-50 px-6 py-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800">
                    ìƒì„¸ ìˆ™ì†Œë³„ ìˆ˜ìµ ë°ì´í„°
                </h3>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìˆ™ì†Œëª…</th>
                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">íˆ¬ìê¸ˆ</th>
                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">ëˆ„ì  ìˆ˜ìµê¸ˆ</th>
                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">ëˆ„ì  ì§€ì¶œê¸ˆ</th>
                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">ëˆ„ì  ìˆœìˆ˜ìµ</th>
    
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">íˆ¬ìì</th>
                        </tr>
                    </thead>
                    <tbody id="dataTable" class="bg-white divide-y divide-gray-200">
                        <!-- Table data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let investors = [];
        let accommodations = [];
        let accountingData = [];

        // ì‹¤ì œ ì‹œìŠ¤í…œ ë°ì´í„° ë¡œë“œ
        async function loadSystemData() {
            console.log('ğŸ“Š ë°ì´í„° ë¡œë”© ì‹œì‘...');
            
            try {
                // localStorageì—ì„œ ë°ì´í„° ë¡œë“œ
                const localInvestors = localStorage.getItem('investorData');
                const localAccommodations = localStorage.getItem('accommodationData');
                const localAccounting = localStorage.getItem('accountingData');
                
                investors = localInvestors ? JSON.parse(localInvestors) : [];
                accommodations = localAccommodations ? JSON.parse(localAccommodations) : [];
                accountingData = localAccounting ? JSON.parse(localAccounting) : [];
                
                console.log('ğŸ“Š ì‹¤ì œ ì‹œìŠ¤í…œ ë°ì´í„° ë¡œë“œ:', {
                    investors: investors.length + 'ëª…',
                    accommodations: accommodations.length + 'ê°œ',
                    accounting: accountingData.length + 'ê±´'
                });
                
                // ì‹¤ì œ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ìƒíƒœë¡œ í‘œì‹œ (ë”ë¯¸ ë°ì´í„° ìƒì„±í•˜ì§€ ì•ŠìŒ)
                
                return true;
            } catch (error) {
                console.error('âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                return false;
            }
        }



        // ì‹¤ì œ ì‹œìŠ¤í…œ ë°ì´í„° ê¸°ë°˜ ëŒ€ì‹œë³´ë“œ ê³„ì‚° (í˜ì´í¬ ë°ì´í„° ì—†ìŒ)
        function calculateDashboardData() {
            console.log('ğŸ§® ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ ê³„ì‚° ì‹œì‘...');
            console.log('ğŸ“‹ ì…ë ¥ ë°ì´í„°:', {
                accommodations: accommodations.length,
                accountingData: accountingData.length,
                investors: investors.length
            });
            
            if (accommodations.length === 0) {
                console.log('âš ï¸ ìˆ™ì†Œ ë°ì´í„°ê°€ ì—†ìŒ - ë¹ˆ ê²°ê³¼ ë°˜í™˜');
                return {
                    properties: [],
                    kpis: {
                        totalProperties: 0,
                        totalInvestment: 0,
                        totalRevenue: 0,
                        totalExpense: 0,
                        netProfit: 0,
    
                        occupancyRate: 0
                    }
                };
            }
            
            const properties = [];
            let totalInvestment = 0;
            let totalRevenue = 0;
            let totalExpense = 0;
            
            // ê° ì‹¤ì œ ìˆ™ì†Œë³„ ê³„ì‚°
            accommodations.forEach((acc, index) => {
                console.log(`ğŸ  ìˆ™ì†Œ ${index + 1} ê³„ì‚°: ${acc.accommodationName || acc.name || 'ì´ë¦„ì—†ìŒ'}`);
                
                // ì‹¤ì œ ì‹œìŠ¤í…œ í•„ë“œëª… ì‚¬ìš©: accommodationIdì™€ ë§¤ì¹­
                const accAccountingData = accountingData.filter(item => {
                    const itemAccId = parseInt(item.accommodationId) || 0;
                    const accId = parseInt(acc.id) || 0;
                    return itemAccId === accId;
                });
                
                console.log(`ğŸ’° ${acc.accommodationName || acc.name}ì˜ íšŒê³„ ë°ì´í„°: ${accAccountingData.length}ê±´`);
                accAccountingData.forEach(item => {
                    console.log(`  - ${item.type}: ${item.amount} (${item.description || 'ì„¤ëª…ì—†ìŒ'})`);
                });
                
                // ì‹¤ì œ ì‹œìŠ¤í…œ í•„ë“œëª… ì‚¬ìš©
                const investment = parseFloat(
                    acc.totalInvestment || 
                    acc.investment || 
                    acc.deposit || // ë³´ì¦ê¸ˆì„ íˆ¬ìê¸ˆìœ¼ë¡œ ì‚¬ìš©
                    acc.monthlyRent * 12 || // ì›”ì„¸ * 12ë¥¼ íˆ¬ìê¸ˆìœ¼ë¡œ ì‚¬ìš©  
                    0
                );
                
                const revenue = accAccountingData
                    .filter(item => (item.type || '').toLowerCase() === 'income')
                    .reduce((sum, item) => sum + parseFloat(item.amount || 0), 0);
                    
                const expense = accAccountingData
                    .filter(item => (item.type || '').toLowerCase() === 'expense')
                    .reduce((sum, item) => sum + parseFloat(item.amount || 0), 0);
                
                const netProfit = revenue - expense;

                
                console.log(`ğŸ“Š ${acc.accommodationName || acc.name} ê³„ì‚° ê²°ê³¼:`, {
                    investment: investment.toLocaleString(),
                    revenue: revenue.toLocaleString(),
                    expense: expense.toLocaleString(),
                    netProfit: netProfit.toLocaleString(),

                });
                
                properties.push({
                    name: acc.accommodationName || acc.name || `ìˆ™ì†Œ ${acc.id}`,
                    investment: investment,
                    totalRevenue: revenue,
                    totalExpense: expense,
                    netProfit: netProfit,

                    investorName: acc.investorName || 'ë¯¸ì§€ì •'
                });
                
                totalInvestment += investment;
                totalRevenue += revenue;
                totalExpense += expense;
            });
            
            const totalNetProfit = totalRevenue - totalExpense;

            const activeProperties = properties.filter(prop => prop.totalRevenue > 0).length;
            const occupancyRate = accommodations.length > 0 ? (activeProperties / accommodations.length) * 100 : 0;
            
            const result = {
                properties: properties,
                kpis: {
                    totalProperties: accommodations.length,
                    totalInvestment: totalInvestment,
                    totalRevenue: totalRevenue,
                    totalExpense: totalExpense,
                    netProfit: totalNetProfit,
    
                    occupancyRate: occupancyRate
                }
            };
            
            console.log('ğŸ¯ ìµœì¢… ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ KPI:', result.kpis);
            return result;
        }

        // ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ KPI ì¹´ë“œ ì—…ë°ì´íŠ¸ (í˜ì´í¬ ë°ì´í„° ì—†ìŒ)
        function updateKPICards(data) {
            console.log('ğŸ“Š ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ KPI ì¹´ë“œ ì—…ë°ì´íŠ¸...');
            console.log('ğŸ“ˆ ì—…ë°ì´íŠ¸í•  KPI:', data.kpis);
            
            const elements = {
                totalProperties: document.querySelector('[data-kpi="total-properties"]'),
                totalInvestment: document.querySelector('[data-kpi="total-investment"]'),
                totalRevenue: document.querySelector('[data-kpi="total-revenue"]'),
                netProfit: document.querySelector('[data-kpi="net-profit"]'),
    
                occupancyRate: document.querySelector('[data-kpi="occupancy-rate"]')
            };
            
            // ì‹¤ì œ ë°ì´í„° í‘œì‹œ (0ì´ì–´ë„ ì‹¤ì œ ê°’)
            if (elements.totalProperties) {
                elements.totalProperties.textContent = data.kpis.totalProperties + 'ê°œ';
                console.log('âœ… ì´ ìˆ™ì†Œ ìˆ˜:', data.kpis.totalProperties + 'ê°œ');
            }
            if (elements.totalInvestment) {
                elements.totalInvestment.textContent = data.kpis.totalInvestment.toLocaleString() + ' THB';
                console.log('âœ… ì´ íˆ¬ìê¸ˆ:', data.kpis.totalInvestment.toLocaleString() + ' THB');
            }
            if (elements.totalRevenue) {
                elements.totalRevenue.textContent = data.kpis.totalRevenue.toLocaleString() + ' THB';
                console.log('âœ… ì´ ìˆ˜ìµ:', data.kpis.totalRevenue.toLocaleString() + ' THB');
            }
            if (elements.netProfit) {
                const netProfitText = data.kpis.netProfit.toLocaleString() + ' THB';
                elements.netProfit.textContent = netProfitText;
                console.log('âœ… ì´ ìˆœìˆ˜ìµ:', netProfitText);
                
                // ìˆœìˆ˜ìµì´ ìŒìˆ˜ë©´ ì¹´ë“œ ìƒ‰ìƒ ë³€ê²½
                const netProfitCard = elements.netProfit.closest('.bg-gradient-to-r');
                if (netProfitCard && data.kpis.netProfit < 0) {
                    netProfitCard.className = netProfitCard.className.replace('from-blue-500 to-blue-600', 'from-red-500 to-red-600');
                }
            }

            if (elements.occupancyRate) {
                elements.occupancyRate.textContent = data.kpis.occupancyRate.toFixed(1) + '%';
                console.log('âœ… ì ìœ ìœ¨:', data.kpis.occupancyRate.toFixed(1) + '%');
            }
            
            console.log('ğŸ‰ ì‹¤ì œ ë°ì´í„° KPI ì—…ë°ì´íŠ¸ ì™„ë£Œ!');
        }

        // ë°ì´í„° í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateDataTable(data) {
            console.log('ğŸ“‹ ë°ì´í„° í…Œì´ë¸” ì—…ë°ì´íŠ¸...');
            
            const tableBody = document.getElementById('dataTable');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            if (data.properties.length === 0) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td colspan="7" class="px-4 py-8 text-center text-gray-500">
                        <div class="flex flex-col items-center">
                            <i class="fas fa-exclamation-triangle text-4xl mb-2 text-yellow-500"></i>
                            <p class="font-semibold text-lg mb-2">ì‹¤ì œ ìˆ™ì†Œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                            <p class="text-sm mb-4">ëŒ€ì‹œë³´ë“œì— ë°ì´í„°ë¥¼ í‘œì‹œí•˜ë ¤ë©´ ë¨¼ì € ë‹¤ìŒì„ ì§„í–‰í•´ì£¼ì„¸ìš”:</p>
                            <div class="text-left text-sm space-y-1">
                                <p>1. <a href="investor.html" class="text-blue-600 hover:underline">íˆ¬ìì ê´€ë¦¬</a>ì—ì„œ íˆ¬ìì ì¶”ê°€</p>
                                <p>2. <a href="accommodation.html" class="text-blue-600 hover:underline">ìˆ™ì†Œ ê´€ë¦¬</a>ì—ì„œ ìˆ™ì†Œ ë“±ë¡</p>
                                <p>3. <a href="accounting.html" class="text-blue-600 hover:underline">ìˆ˜ìµ ê´€ë¦¬</a>ì—ì„œ ìˆ˜ì…/ì§€ì¶œ ì…ë ¥</p>
                            </div>
                        </div>
                    </td>
                `;
                tableBody.appendChild(tr);
                return;
            }
            
            data.properties.forEach((property) => {
                const netProfitColorClass = property.netProfit >= 0 ? 'text-green-600' : 'text-red-600';
                
                const tr = document.createElement('tr');
                tr.className = 'hover:bg-gray-50';
                
                tr.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">${property.name}</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900 font-mono">${property.investment.toLocaleString()} THB</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-right text-green-600 font-mono">${property.totalRevenue.toLocaleString()} THB</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-right text-red-600 font-mono">${property.totalExpense.toLocaleString()} THB</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-right ${netProfitColorClass} font-mono font-semibold">${property.netProfit.toLocaleString()} THB</td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${property.investorName}</td>
                `;
                
                tableBody.appendChild(tr);
            });
            
            console.log('âœ… í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì™„ë£Œ:', data.properties.length + 'ê°œ í–‰');
        }

        // ë©”ì¸ ì´ˆê¸°í™” í•¨ìˆ˜
        async function initializeIndexDashboard() {
            try {
                console.log('ğŸš€ Index ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘');
                
                // ë°ì´í„° ë¡œë“œ
                const dataLoaded = await loadSystemData();
                if (!dataLoaded) {
                    console.error('âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨');
                    return;
                }
                
                // ê³„ì‚°
                const calculatedData = calculateDashboardData();
                
                // í™”ë©´ ì—…ë°ì´íŠ¸
                updateKPICards(calculatedData);
                updateDataTable(calculatedData);
                
                console.log('ğŸ‰ Index ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì™„ë£Œ!');
                
            } catch (error) {
                console.error('âŒ Index ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            }
        }

        // ë”ë¯¸ í•¨ìˆ˜ë“¤ (ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ í˜¸í™˜ì„±)
        // ë¡œê·¸ì¸ ì²´í¬ëŠ” auth.jsì—ì„œ ì²˜ë¦¬

        // ì‹ ê·œ í™˜ê²½ ì²´í¬ ë° ìë™ Firebase ì„¤ì •
        async function checkAndSetupNewEnvironment() {
            console.log('ğŸ” ì‹ ê·œ í™˜ê²½ ì²´í¬ ì‹œì‘...');
            
            // ë¡œì»¬ ë°ì´í„° ì²´í¬
            const localDataExists = checkLocalDataExists();
            
            if (!localDataExists) {
                console.log('ğŸ“± ì‹ ê·œ ì ‘ì† í™˜ê²½ ê°ì§€: ë¡œì»¬ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                
                // Firebase ì„¤ì • íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸
                if (typeof firebaseStorage === 'undefined') {
                    // Firebase Storage ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
                    await loadFirebaseStorageScript();
                }
                
                // Firebase ìë™ ì„¤ì • ë° ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
                await autoSetupFirebaseAndMigrate();
            } else {
                console.log('âœ… ê¸°ì¡´ ì‚¬ìš©ì: ë¡œì»¬ ë°ì´í„°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.');
            }
        }

        // ë¡œì»¬ ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ ì²´í¬
        function checkLocalDataExists() {
            const investorData = JSON.parse(localStorage.getItem('investorData') || '[]');
            const accommodationData = JSON.parse(localStorage.getItem('accommodationData') || '[]');
            const reservationData = JSON.parse(localStorage.getItem('reservationData') || '[]');
            const accountingData = JSON.parse(localStorage.getItem('accountingData') || '[]');
            
            const totalRecords = investorData.length + accommodationData.length + reservationData.length + accountingData.length;
            
            console.log(`ğŸ“Š ë¡œì»¬ ë°ì´í„° í˜„í™©: íˆ¬ìì ${investorData.length}, ìˆ™ì†Œ ${accommodationData.length}, ì˜ˆì•½ ${reservationData.length}, íšŒê³„ ${accountingData.length} (ì´ ${totalRecords}ê±´)`);
            
            return totalRecords > 0;
        }

        // Firebase Storage ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
        function loadFirebaseStorageScript() {
            return new Promise((resolve, reject) => {
                if (typeof firebaseStorage !== 'undefined') {
                    resolve();
                    return;
                }

                const script = document.createElement('script');
                script.src = 'js/firebase-storage.js';
                script.onload = () => {
                    console.log('ğŸ”¥ Firebase Storage ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ');
                    resolve();
                };
                script.onerror = () => {
                    console.error('âŒ Firebase Storage ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨');
                    reject(new Error('Firebase Storage script failed to load'));
                };
                document.head.appendChild(script);
            });
        }

        // Firebase ìë™ ì„¤ì • ë° ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
        async function autoSetupFirebaseAndMigrate() {
            try {
                console.log('ğŸ”§ Firebase ìë™ ì„¤ì • ì‹œì‘...');
                
                // Firebase ê¸°ë³¸ ì„¤ì •ê°’
                const defaultApiKey = 'AIzaSyDyZVJn5-MFuxFzBc3OaKwnsJgvCHE20P8';
                const defaultProjectId = 'teamk-airbnb';
                
                // Firebase ì„¤ì • ì €ì¥
                firebaseStorage.saveConfig(defaultApiKey, defaultProjectId);
                console.log('âœ… Firebase ì„¤ì • ì €ì¥ ì™„ë£Œ');
                
                // ì—°ê²° í…ŒìŠ¤íŠ¸
                console.log('ğŸ”Œ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...');
                const connectionResult = await firebaseStorage.testConnection();
                
                if (connectionResult.success) {
                    console.log('âœ… Firebase ì—°ê²° ì„±ê³µ:', connectionResult.message);
                    
                    // Firebase â†’ ë¡œì»¬ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œì‘
                    console.log('ğŸ“¥ Firebase â†’ ë¡œì»¬ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œì‘...');
                    
                    await autoMigrateFirebaseToLocal();
                    
                    console.log('ğŸ‰ ì‹ ê·œ í™˜ê²½ ì„¤ì • ì™„ë£Œ!');
                    
                    // ì„±ê³µ ì•Œë¦¼ (ì„ íƒì )
                    showAutoSetupNotification();
                    
                } else {
                    console.error('âŒ Firebase ì—°ê²° ì‹¤íŒ¨:', connectionResult.error);
                    console.log('ğŸ’¡ Firebase ì—°ê²°ì— ì‹¤íŒ¨í–ˆì§€ë§Œ, ë¡œì»¬ í™˜ê²½ìœ¼ë¡œ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.');
                }
                
            } catch (error) {
                console.error('âŒ Firebase ìë™ ì„¤ì • ì¤‘ ì˜¤ë¥˜:', error);
                console.log('ğŸ’¡ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì§€ë§Œ, ë¡œì»¬ í™˜ê²½ìœ¼ë¡œ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.');
            }
        }

        // Firebase â†’ ë¡œì»¬ ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜
        async function autoMigrateFirebaseToLocal() {
            try {
                // íˆ¬ìì ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
                const investors = await firebaseStorage.loadInvestors();
                if (investors.length > 0) {
                    localStorage.setItem('investorData', JSON.stringify(investors));
                    console.log(`âœ… íˆ¬ìì ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ: ${investors.length}ëª…`);
                }

                // ìˆ™ì†Œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
                const accommodations = await firebaseStorage.loadAccommodations();
                if (accommodations.length > 0) {
                    localStorage.setItem('accommodationData', JSON.stringify(accommodations));
                    console.log(`âœ… ìˆ™ì†Œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ: ${accommodations.length}ê°œ`);
                }

                // ì˜ˆì•½ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
                const reservations = await firebaseStorage.loadReservations();
                if (reservations.length > 0) {
                    localStorage.setItem('reservationData', JSON.stringify(reservations));
                    console.log(`âœ… ì˜ˆì•½ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ: ${reservations.length}ê±´`);
                }

                // íšŒê³„ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
                const accounting = await firebaseStorage.loadAccounting();
                if (accounting.length > 0) {
                    localStorage.setItem('accountingData', JSON.stringify(accounting));
                    console.log(`âœ… íšŒê³„ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ: ${accounting.length}ê±´`);
                }

                console.log('ğŸ‰ ëª¨ë“  ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ!');
                
            } catch (error) {
                console.error('âŒ ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘ ì˜¤ë¥˜:', error);
            }
        }

        // ë²”ìš© ì•Œë¦¼ í‘œì‹œ í•¨ìˆ˜
        function showNotification(title, message, type = 'info') {
            const notification = document.createElement('div');
            
            let bgColor, iconClass;
            switch(type) {
                case 'success':
                    bgColor = 'bg-green-600';
                    iconClass = 'fas fa-check-circle';
                    break;
                case 'error':
                    bgColor = 'bg-red-600';
                    iconClass = 'fas fa-exclamation-triangle';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-600';
                    iconClass = 'fas fa-exclamation-circle';
                    break;
                default:
                    bgColor = 'bg-blue-600';
                    iconClass = 'fas fa-info-circle';
                    break;
            }
            
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="${iconClass} mr-2"></i>
                    <div>
                        <div class="font-semibold">${title}</div>
                        <div class="text-sm opacity-90">${message}</div>
                    </div>
                </div>
            `;
            document.body.appendChild(notification);
            
            // ìë™ ì œê±°
            const duration = type === 'error' ? 7000 : 5000; // ì˜¤ë¥˜ëŠ” 7ì´ˆ, ë‚˜ë¨¸ì§€ëŠ” 5ì´ˆ
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, duration);
        }

        // ìë™ ì„¤ì • ì™„ë£Œ ì•Œë¦¼ (ì„ íƒì )
        function showAutoSetupNotification() {
            showNotification('ì‹ ê·œ í™˜ê²½ ì„¤ì • ì™„ë£Œ', 'Firebase ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        // Firebase ìë™ ë™ê¸°í™” í•¨ìˆ˜
        async function performAutoSync() {
            console.log('ğŸ”„ ìë™ Firebase ë™ê¸°í™” ì‹œì‘');
            
            const syncAlert = document.getElementById('syncStatusAlert');
            const syncIcon = document.getElementById('syncIcon');
            const syncMessage = document.getElementById('syncMessage');
            const manualSyncBtn = document.getElementById('manualSyncBtn');
            
            // ë™ê¸°í™” ìƒíƒœ í‘œì‹œ
            syncAlert.classList.remove('hidden');
            syncAlert.className = 'mb-6 p-4 rounded-lg shadow-sm border-l-4 border-blue-500 bg-blue-50';
            syncIcon.className = 'fas fa-sync-alt animate-spin text-blue-600 mr-3';
            syncMessage.textContent = 'Firebaseì—ì„œ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...';
            
            // ìˆ˜ë™ ë™ê¸°í™” ë²„íŠ¼ ë¹„í™œì„±í™”
            if (manualSyncBtn) {
                manualSyncBtn.disabled = true;
                manualSyncBtn.className = 'ml-4 px-3 py-1 text-xs bg-gray-400 text-white rounded cursor-not-allowed';
            }
            
            try {
                // Firebase ì—°ê²° ìƒíƒœ í™•ì¸
                if (typeof firebaseStorage === 'undefined') {
                    throw new Error('Firebase Storage ëª¨ë“ˆì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                if (!firebaseStorage.isConfigured()) {
                    throw new Error('Firebase ì„¤ì •ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë°ì´í„° ê´€ë¦¬ íƒ­ì—ì„œ Firebaseë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                }
                
                console.log('âœ… Firebase ì—°ê²° í™•ì¸ë¨, ë°ì´í„° ë™ê¸°í™” ì‹œì‘');
                
                let syncCount = 0;
                let totalItems = 0;
                
                // 1. ìˆ™ì†Œ ë°ì´í„° ë™ê¸°í™”
                try {
                    syncMessage.textContent = 'ìˆ™ì†Œ ë°ì´í„° ë™ê¸°í™” ì¤‘...';
                    const accommodations = await firebaseStorage.loadAccommodations();
                    if (accommodations && accommodations.length > 0) {
                        localStorage.setItem('accommodationData', JSON.stringify(accommodations));
                        syncCount++;
                        totalItems += accommodations.length;
                        console.log(`âœ… ìˆ™ì†Œ ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ: ${accommodations.length}ê°œ`);
                    } else {
                        console.log('â„¹ï¸ ë™ê¸°í™”í•  ìˆ™ì†Œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.warn('âš ï¸ ìˆ™ì†Œ ë°ì´í„° ë™ê¸°í™” ì‹¤íŒ¨:', error.message);
                }
                
                // 2. íˆ¬ìì ë°ì´í„° ë™ê¸°í™”
                try {
                    syncMessage.textContent = 'íˆ¬ìì ë°ì´í„° ë™ê¸°í™” ì¤‘...';
                    const investors = await firebaseStorage.loadInvestors();
                    if (investors && investors.length > 0) {
                        localStorage.setItem('investorData', JSON.stringify(investors));
                        syncCount++;
                        totalItems += investors.length;
                        console.log(`âœ… íˆ¬ìì ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ: ${investors.length}ê°œ`);
                    } else {
                        console.log('â„¹ï¸ ë™ê¸°í™”í•  íˆ¬ìì ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.warn('âš ï¸ íˆ¬ìì ë°ì´í„° ë™ê¸°í™” ì‹¤íŒ¨:', error.message);
                }
                
                // 3. ì˜ˆì•½ ë°ì´í„° ë™ê¸°í™”
                try {
                    syncMessage.textContent = 'ì˜ˆì•½ ë°ì´í„° ë™ê¸°í™” ì¤‘...';
                    const reservations = await firebaseStorage.loadReservations();
                    if (reservations && reservations.length > 0) {
                        localStorage.setItem('reservationData', JSON.stringify(reservations));
                        syncCount++;
                        totalItems += reservations.length;
                        console.log(`âœ… ì˜ˆì•½ ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ: ${reservations.length}ê°œ`);
                    } else {
                        console.log('â„¹ï¸ ë™ê¸°í™”í•  ì˜ˆì•½ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.warn('âš ï¸ ì˜ˆì•½ ë°ì´í„° ë™ê¸°í™” ì‹¤íŒ¨:', error.message);
                }
                
                // 4. íšŒê³„ ë°ì´í„° ë™ê¸°í™”
                try {
                    syncMessage.textContent = 'íšŒê³„ ë°ì´í„° ë™ê¸°í™” ì¤‘...';
                    const accounting = await firebaseStorage.loadAccounting();
                    if (accounting && accounting.length > 0) {
                        localStorage.setItem('accountingData', JSON.stringify(accounting));
                        syncCount++;
                        totalItems += accounting.length;
                        console.log(`âœ… íšŒê³„ ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ: ${accounting.length}ê°œ`);
                    } else {
                        console.log('â„¹ï¸ ë™ê¸°í™”í•  íšŒê³„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.warn('âš ï¸ íšŒê³„ ë°ì´í„° ë™ê¸°í™” ì‹¤íŒ¨:', error.message);
                }
                
                // 5. ì •ì‚° ë°ì´í„°ëŠ” ë‹¤ë¥¸ ë°ì´í„°ë¡œë¶€í„° ê³„ì‚°ë˜ë¯€ë¡œ ë³„ë„ ë™ê¸°í™” ë¶ˆí•„ìš”
                console.log('â„¹ï¸ ì •ì‚° ë°ì´í„°ëŠ” ì‹¤ì‹œê°„ ê³„ì‚°ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.');
                
                // ì„±ê³µ ìƒíƒœ í‘œì‹œ
                if (totalItems > 0) {
                    syncIcon.className = 'fas fa-check-circle text-green-600 mr-3';
                    syncAlert.className = 'mb-6 p-4 rounded-lg shadow-sm border-l-4 border-green-500 bg-green-50';
                    syncMessage.innerHTML = `
                        <span class="text-green-800 font-semibold">ë™ê¸°í™” ì™„ë£Œ!</span><br>
                        <span class="text-green-600 text-sm">${syncCount}ê°œ ë°ì´í„° íƒ€ì…, ì´ ${totalItems}ê°œ í•­ëª©ì´ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</span>
                    `;
                    
                    // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                    console.log('ğŸ”„ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨');
                    initializeIndexDashboard();
                    
                    showNotification('âœ… ë™ê¸°í™” ì™„ë£Œ', `${totalItems}ê°œ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                } else if (syncCount > 0) {
                    // ì¼ë¶€ ë°ì´í„°ëŠ” ë™ê¸°í™”ë˜ì—ˆì§€ë§Œ ìƒˆ ë°ì´í„°ê°€ ì—†ìŒ
                    syncIcon.className = 'fas fa-info-circle text-blue-600 mr-3';
                    syncAlert.className = 'mb-6 p-4 rounded-lg shadow-sm border-l-4 border-blue-500 bg-blue-50';
                    syncMessage.innerHTML = `
                        <span class="text-blue-800 font-semibold">ë™ê¸°í™” í™•ì¸ ì™„ë£Œ</span><br>
                        <span class="text-blue-600 text-sm">${syncCount}ê°œ ë°ì´í„° íƒ€ì…ì„ í™•ì¸í–ˆì§€ë§Œ ìƒˆë¡œìš´ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</span>
                    `;
                    showNotification('â„¹ï¸ ë™ê¸°í™” í™•ì¸ ì™„ë£Œ', 'Firebaseì— ìƒˆë¡œìš´ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'info');
                } else {
                    // ë™ê¸°í™”í•  ë°ì´í„°ê°€ ì „í˜€ ì—†ìŒ
                    syncIcon.className = 'fas fa-exclamation-circle text-yellow-600 mr-3';
                    syncAlert.className = 'mb-6 p-4 rounded-lg shadow-sm border-l-4 border-yellow-500 bg-yellow-50';
                    syncMessage.innerHTML = `
                        <span class="text-yellow-800 font-semibold">ë™ê¸°í™”í•  ë°ì´í„° ì—†ìŒ</span><br>
                        <span class="text-yellow-600 text-sm">Firebaseì— ë“±ë¡ëœ ë°ì´í„°ê°€ ì—†ê±°ë‚˜ ì—°ê²°ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
                    `;
                    showNotification('âš ï¸ ë°ì´í„° ì—†ìŒ', 'Firebaseë¥¼ í™•ì¸í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”.', 'warning');
                }
                
                // 3ì´ˆ í›„ ì•Œë¦¼ ìˆ¨ê¸°ê¸°
                setTimeout(() => {
                    syncAlert.classList.add('hidden');
                }, 3000);
                
                // ìˆ˜ë™ ë™ê¸°í™” ë²„íŠ¼ ì¬í™œì„±í™”
                if (manualSyncBtn) {
                    manualSyncBtn.disabled = false;
                    manualSyncBtn.className = 'ml-4 px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors';
                }
                
            } catch (error) {
                console.error('âŒ ìë™ ë™ê¸°í™” ì‹¤íŒ¨:', error);
                
                // ì˜¤ë¥˜ ìƒíƒœ í‘œì‹œ
                syncIcon.className = 'fas fa-exclamation-triangle text-red-600 mr-3';
                syncAlert.className = 'mb-6 p-4 rounded-lg shadow-sm border-l-4 border-red-500 bg-red-50';
                syncMessage.innerHTML = `
                    <span class="text-red-800 font-semibold">ë™ê¸°í™” ì‹¤íŒ¨</span><br>
                    <span class="text-red-600 text-sm">${error.message}</span>
                `;
                
                showNotification('âš ï¸ ë™ê¸°í™” ì‹¤íŒ¨', 'Firebase ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
                
                // 5ì´ˆ í›„ ì•Œë¦¼ ìˆ¨ê¸°ê¸°
                setTimeout(() => {
                    syncAlert.classList.add('hidden');
                }, 5000);
            }
            
            // ìˆ˜ë™ ë™ê¸°í™” ë²„íŠ¼ ì¬í™œì„±í™”
            if (manualSyncBtn) {
                manualSyncBtn.disabled = false;
                manualSyncBtn.className = 'ml-4 px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Index í˜ì´ì§€ ë¡œë“œ ì‹œì‘');
            
            // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ (ê´€ë¦¬ì ì „ìš©)
            const isLoggedIn = checkLoginStatus();
            console.log('ğŸ” ë¡œê·¸ì¸ ìƒíƒœ:', isLoggedIn);
            
            if (!isLoggedIn) {
                console.log('âŒ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - ë™ê¸°í™” ê±´ë„ˆëœ€');
                return;
            }
            
            console.log('âœ… ë¡œê·¸ì¸ í™•ì¸ë¨ - í˜ì´ì§€ ì´ˆê¸°í™” ì‹œì‘');
            initializePagePermissions();
            
            // 1ì´ˆ í›„ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ë° ì‹ ê·œ í™˜ê²½ ì²´í¬ (DOM ì™„ì „ ë¡œë“œ ëŒ€ê¸°)
            setTimeout(async () => {
                console.log('â° 1ì´ˆ ëŒ€ê¸° ì™„ë£Œ - ì´ˆê¸°í™” ì‹œì‘');
                
                try {
                    await checkAndSetupNewEnvironment();
                    console.log('âœ… ì‹ ê·œ í™˜ê²½ ì²´í¬ ì™„ë£Œ');
                    
                    // **ğŸ”„ ìë™ Firebase ë™ê¸°í™” ì‹¤í–‰ (ë¬´ì¡°ê±´ ì‹¤í–‰)**
                    console.log('ğŸš€ ë¡œê·¸ì¸ í›„ ìë™ Firebase ë™ê¸°í™” ì‹œì‘');
                    await performAutoSync();
                    console.log('âœ… ìë™ ë™ê¸°í™” ì™„ë£Œ');
                    
                    // ë™ê¸°í™” í›„ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
                    console.log('ğŸ“Š ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘');
                    initializeIndexDashboard();
                    console.log('âœ… ì „ì²´ ì´ˆê¸°í™” ì™„ë£Œ');
                    
                } catch (error) {
                    console.error('âŒ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    showNotification('ì´ˆê¸°í™” ì˜¤ë¥˜', 'í˜ì´ì§€ ì´ˆê¸°í™” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }, 1000);
        });
    </script>
</body>
</html>